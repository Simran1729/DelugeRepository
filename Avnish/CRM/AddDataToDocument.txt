data = zoho.crm.getRecordById("Deals",id);
Broker_Email = data.getJson("Broker_Email");
Business_Vertical = data.getJson("Business_Vertical");
if(Business_Vertical == "Construction")
{
	tempID = "1lpx3fa844ed9baa64d2191ddce0ddb5e7ab3";
}
else if(Business_Vertical == "Mining")
{
	tempID = "1lpx3f20e1c00b4ab438bb5b96b6855466663";
}
else if(Business_Vertical == "General and Commercial" || Business_Vertical == "Trade Guarantees")
{
	tempID = "1lpx318d43581c0bc4115acfdc68d80aecae6";
}
else
{
	tempID = "";
}
// Deal_Name = data.getjson("Deal_Name");
// Registration_Name = data.getjson("Registration_Number");
// Company = data.getjson("Company");
// Total_facility_limit_required = data.getjson("Total_facility_limit_required");
// Guarantees_value = data.getjson("Guarantees_value");
// Client_Name = data.getjson("Client_Name");
// Broker_Email = data.getjson("Broker_Email");
// Mobile_Number = data.getjson("Mobile_Number");
// Value_of_Guarantee = data.getjson("Value_of_Guarantee");
// Brokerage = data.getjson("Brokerage");
// stage = data.getjson("Stage");
// state_visit = data.getjsom("Site_Visit");
// currency = data.getjson("Currency");
// Current_New_Client = data.getjson("Current_New_Client");
Acceptance_Date = data.getJson("Acceptance_Date");
Account_Name = data.getJson("Account_Name");
Allocated_Tier = data.getJson("Allocated_Tier");
Allocated_tier_1 = data.getJson("Allocated_tier_1");
Application_No = data.getJson("Application_No");
Application_Number = data.getJson("Application_Number");
Benefeciary = data.getJson("Benefeciary");
Broker_Region = data.getJson("Broker_Region");
Brokerage = data.getJson("Brokerage");
Broker_Name = data.getJson("Broker_Name");
// Business_Vertical = data.getJson("Business_Vertical");
Client_Industry = data.getJson("Client_Industry");
Closing_Date = data.getJson("Closing_Date");
Comments = data.getJson("Comments");
Commodity = data.getJson("Commodity");
Contact_Name = data.getJson("Contact_Name");
Currency = data.getJson("Currency");
Current_New_Client = data.getJson("Current_New_Client");
Deal_Name = data.getJson("Deal_Name");
Owner = data.getJson("Owner");
Deal_Source = data.getJson("Deal_Source");
Disable_Button_1 = data.getJson("Disable_Button_1");
// Broker_Email = data.getJson("Broker_Email");
Enquiry_Date = data.getJson("Enquiry_Date");
Exchange_Rate = data.getJson("Exchange_Rate");
Exposure_Gtee = data.getJson("Exposure_Gtee");
Total_facility_limit_required = data.getJson("Total_facility_limit_required");
Foreign_Guarantees_Rate = data.getJson("Foreign_Guarantees_Rate");
Guarantee_Fees = data.getJson("Guarantee_Fees");
Guarantee_Type = data.getJson("Guarantee_Type");
Guarantees_value = data.getJson("Guarantees_value");
Hide_Dev_Section = data.getJson("Hide_Dev_Section");
Is_there_broker_on_this_facility = data.getJson("Is_there_broker_on_this_facility");
JVCC_Rate = data.getJson("JVCC_Rate");
Last_Update_Date = data.getJson("Last_Update_Date");
Layout = data.getJson("Layout");
States = data.getJson("States");
Meeting = data.getJson("Meeting");
Mobile_Number = data.getJson("Mobile_Number");
Non_Acceptance_Reason = data.getJson("Non_Acceptance_Reason");
Pick_Business_Vertical = data.getJson("Pick_Business_Vertical");
Placement_fee = data.getJson("Placement_fee");
Revenue = data.getJson("Revenue");
Premium_Rate = data.getJson("Premium_Rate");
Document_URL = data.getJson("Document_URL");
Quote_Sent_Date = data.getJson("Quote_Sent_Date");
Rate_charged = data.getJson("Rate_charged");
Reason_For_Loss__s = data.getJson("Reason_For_Loss__s");
Referral_Date = data.getJson("Referral_Date");
Referral_Reason = data.getJson("Referral_Reason");
Registration_No = data.getJson("Registration_No");
SA_normal_Rate = data.getJson("SA_normal_Rate");
Securities = data.getJson("Securities");
Site_Visit = data.getJson("Site_Visit");
Stage = data.getJson("Stage");
Tag = data.getJson("Tag");
Email_Address1 = data.getJson("Email_Address1");
productData = Map();
productData.put("Acceptance_Date",Acceptance_Date);
productData.put("Account_Name",Account_Name);
productData.put("Allocated_Tier",Allocated_Tier);
productData.put("Allocated_tier_1",Allocated_tier_1);
productData.put("Application_No",Application_No);
productData.put("Application_Number",Application_Number);
productData.put("Benefeciary",Benefeciary);
productData.put("Broker_Region",Broker_Region);
productData.put("Brokerage",Brokerage);
productData.put("Broker_Name",Broker_Name);
productData.put("Business_Vertical",Business_Vertical);
productData.put("Client_Industry",Client_Industry);
productData.put("Closing_Date",Closing_Date);
productData.put("Comments",Comments);
productData.put("Commodity",Commodity);
productData.put("Contact_Name",Contact_Name);
productData.put("Currency",Currency);
productData.put("Current_New_Client",Current_New_Client);
productData.put("Deal_Name",Deal_Name);
productData.put("Owner",Owner);
productData.put("Deal_Source",Deal_Source);
productData.put("Disable_Button_1",Disable_Button_1);
productData.put("Broker_Email",Broker_Email);
productData.put("Enquiry_Date",Enquiry_Date);
productData.put("Exchange_Rate",Exchange_Rate);
productData.put("Exposure_Gtee",Exposure_Gtee);
productData.put("Total_facility_limit_required",Total_facility_limit_required);
productData.put("Foreign_Guarantees_Rate",Foreign_Guarantees_Rate);
productData.put("Guarantee_Fees",Guarantee_Fees);
productData.put("Guarantee_Type",Guarantee_Type);
productData.put("Guarantees_value",Guarantees_value);
productData.put("Hide_Dev_Section",Hide_Dev_Section);
productData.put("Is_there_broker_on_this_facility",Is_there_broker_on_this_facility);
productData.put("JVCC_Rate",JVCC_Rate);
productData.put("Last_Update_Date",Last_Update_Date);
productData.put("Layout",Layout);
productData.put("States",States);
productData.put("Meeting",Meeting);
productData.put("Mobile_Number",Mobile_Number);
productData.put("Non_Acceptance_Reason",Non_Acceptance_Reason);
productData.put("Pick_Business_Vertical",Pick_Business_Vertical);
productData.put("Placement_fee",Placement_fee);
productData.put("Revenue",Revenue);
productData.put("Premium_Rate",Premium_Rate);
productData.put("Document_URL",Document_URL);
productData.put("Quote_Sent_Date",Quote_Sent_Date);
productData.put("Rate_charged",Rate_charged);
productData.put("Reason_For_Loss__s",Reason_For_Loss__s);
productData.put("Referral_Date",Referral_Date);
productData.put("Referral_Reason",Referral_Reason);
productData.put("Registration_No",Registration_No);
productData.put("SA_normal_Rate",SA_normal_Rate);
productData.put("Securities",Securities);
productData.put("Site_Visit",Site_Visit);
productData.put("Stage",Stage);
productData.put("Tag",Tag);
productData.put("Email_Address1",Email_Address1);
// productData.put("Deal_Name",Deal_Name);
// productData.put("Registration_Name",Registration_Name);
// productData.put("Company",Company);
// productData.put("Total_facility_limit_required",Total_facility_limit_required);
// productData.put("Guarantees_value",Guarantees_value);
// productData.put("Client_Name",Client_Name);
// productData.put("Broker_Email",Broker_Email);
// productData.put("Mobile_Number",Mobile_Number);
// productData.put("Value_of_Guarantee",Value_of_Guarantee);
// productData.put("Brokerage",Brokerage);
//Deal_Name = data.getjson("Deal_Name");
// Deal_Name = data.getjson("Deal_Name");
// Street = data.getjson("Street");
// City = data.getjson("City");
// State = data.getjson("State");
// Zip_Code = data.getjson("Zip_Code");
// Deal_Name = data.getjson("Deal_Name");
// Premium_Rate_TO1 = data.getjson("Premium_Rate_TO1");
// Premium_Rate_TO2 = data.getjson("Premium_Rate_TO2");
// Premium_Rate_TO3 = data.getjson("Premium_Rate_TO3");
// Premium_Rate_TO4 = data.getjson("Premium_Rate_TO4");
// Premium_Rate_TO5 = data.getjson("Premium_Rate_TO5");
// Premium_Rate_TO6 = data.getjson("Premium_Rate_TO6");
// Premium_Rate_TO7 = data.getjson("Premium_Rate_TO7");
// Premium_Rate_TO8 = data.getjson("Premium_Rate_TO8");
// Admin_Annual_Fee1 = data.getjson("Admin_Annual_Fee1");
// Admin_Annual_Fee2 = data.getjson("Admin_Annual_Fee2");
// Admin_Annual_Fee3 = data.getjson("Admin_Annual_Fee3");
// Admin_Annual_Fee4 = data.getjson("Admin_Annual_Fee4");
// Admin_Annual_Fee5 = data.getjson("Admin_Annual_Fee5");
// Admin_Annual_Fee6 = data.getjson("Admin_Annual_Fee6");
// Admin_Annual_Fee7 = data.getjson("Admin_Annual_Fee7");
// Admin_Annual_Fee8 = data.getjson("Admin_Annual_Fee8");
// Non_Qualifying_Loss1 = data.getjson("Non_Qualifying_Loss1");
// Non_Qualifying_Loss2 = data.getjson("Non_Qualifying_Loss2");
// Non_Qualifying_Loss3 = data.getjson("Non_Qualifying_Loss3");
// Non_Qualifying_Loss4 = data.getjson("Non_Qualifying_Loss4");
// Non_Qualifying_Loss5 = data.getjson("Non_Qualifying_Loss5");
// Non_Qualifying_Loss6 = data.getjson("Non_Qualifying_Loss6");
// Non_Qualifying_Loss7 = data.getjson("Non_Qualifying_Loss7");
// Non_Qualifying_Loss8 = data.getjson("Non_Qualifying_Loss8");
// Limit_of_Discretion1 = data.getjson("Limit_of_Discretion1");
// Limit_of_Discretion2 = data.getjson("Limit_of_Discretion2");
// Limit_of_Discretion3 = data.getjson("Limit_of_Discretion3");
// Limit_of_Discretion4 = data.getjson("Limit_of_Discretion4");
// Limit_of_Discretion5 = data.getjson("Limit_of_Discretion5");
// Limit_of_Discretion6 = data.getjson("Limit_of_Discretion6");
// Limit_of_Discretion7 = data.getjson("Limit_of_Discretion7");
// Limit_of_Discretion8 = data.getjson("Limit_of_Discretion8");
// Aggregate_First_Loss1 = data.getjson("Aggregate_First_Loss1");
// Aggregate_First_Loss2 = data.getjson("Aggregate_First_Loss2");
// Aggregate_First_Loss3 = data.getjson("Aggregate_First_Loss3");
// Aggregate_First_Loss4 = data.getjson("Aggregate_First_Loss4");
// Aggregate_First_Loss5 = data.getjson("Aggregate_First_Loss5");
// Aggregate_First_Loss6 = data.getjson("Aggregate_First_Loss6");
// Aggregate_First_Loss7 = data.getjson("Aggregate_First_Loss7");
// Aggregate_First_Loss8 = data.getjson("Aggregate_First_Loss8");
// Maximum_Liability1 = data.getjson("Maximum_Liability1");
// Maximum_Liability2 = data.getjson("Maximum_Liability2");
// Maximum_Liability3 = data.getjson("Maximum_Liability3");
// Maximum_Liability4 = data.getjson("Maximum_Liability4");
// Maximum_Liability5 = data.getjson("Maximum_Liability5");
// Maximum_Liability6 = data.getjson("Maximum_Liability6");
// Maximum_Liability7 = data.getjson("Maximum_Liability7");
// Maximum_Liability8 = data.getjson("Maximum_Liability8");
// Insured_Percentage1 = data.getjson("Insured_Percentage1");
// Insured_Percentage2 = data.getjson("Insured_Percentage2");
// Insured_Percentage3 = data.getjson("Insured_Percentage3");
// Insured_Percentage4 = data.getjson("Insured_Percentage4");
// Insured_Percentage5 = data.getjson("Insured_Percentage5");
// Insured_Percentage6 = data.getjson("Insured_Percentage6");
// Insured_Percentage7 = data.getjson("Insured_Percentage7");
// Insured_Percentage8 = data.getjson("Insured_Percentage8");
// Policy_Performance_Bonus1 = data.getjson("Policy_Performance_Bonus1");
// Policy_Performance_Bonus2 = data.getjson("Policy_Performance_Bonus2");
// Policy_Performance_Bonus3 = data.getjson("Policy_Performance_Bonus3");
// Policy_Performance_Bonus4 = data.getjson("Policy_Performance_Bonus4");
// Policy_Performance_Bonus5 = data.getjson("Policy_Performance_Bonus5");
// Policy_Performance_Bonus6 = data.getjson("Policy_Performance_Bonus6");
// Policy_Performance_Bonus7 = data.getjson("Policy_Performance_Bonus7");
// Policy_Performance_Bonus8 = data.getjson("Policy_Performance_Bonus8");
// productData.put("Street",Street);
// productData.put("City",City);
// productData.put("State",State);
// productData.put("Zip_Code",Zip_Code);
// productData.put("Deal_Name",Deal_Name);
// productData.put("Broker_Email",Broker_Email);
// productData.put("Premium_Rate_TO1",Premium_Rate_TO1);
// productData.put("Premium_Rate_TO2",Premium_Rate_TO2);
// productData.put("Premium_Rate_TO3",Premium_Rate_TO3);
// productData.put("Premium_Rate_TO4",Premium_Rate_TO4);
// productData.put("Premium_Rate_TO5",Premium_Rate_TO5);
// productData.put("Premium_Rate_TO6",Premium_Rate_TO6);
// productData.put("Premium_Rate_TO7",Premium_Rate_TO7);
// productData.put("Premium_Rate_TO8",Premium_Rate_TO8);
// productData.put("Admin_Annual_Fee1",Admin_Annual_Fee1);
// productData.put("Admin_Annual_Fee2",Admin_Annual_Fee2);
// productData.put("Admin_Annual_Fee3",Admin_Annual_Fee3);
// productData.put("Admin_Annual_Fee4",Admin_Annual_Fee4);
// productData.put("Admin_Annual_Fee5",Admin_Annual_Fee5);
// productData.put("Admin_Annual_Fee6",Admin_Annual_Fee6);
// productData.put("Admin_Annual_Fee7",Admin_Annual_Fee7);
// productData.put("Admin_Annual_Fee8",Admin_Annual_Fee8);
// productData.put("Non_Qualifying_Loss1",Non_Qualifying_Loss1);
// productData.put("Non_Qualifying_Loss2",Non_Qualifying_Loss2);
// productData.put("Non_Qualifying_Loss3",Non_Qualifying_Loss3);
// productData.put("Non_Qualifying_Loss4",Non_Qualifying_Loss4);
// productData.put("Non_Qualifying_Loss5",Non_Qualifying_Loss5);
// productData.put("Non_Qualifying_Loss6",Non_Qualifying_Loss6);
// productData.put("Non_Qualifying_Loss7",Non_Qualifying_Loss7);
// productData.put("Non_Qualifying_Loss8",Non_Qualifying_Loss8);
// productData.put("Limit_of_Discretion1",Limit_of_Discretion1);
// productData.put("Limit_of_Discretion2",Limit_of_Discretion2);
// productData.put("Limit_of_Discretion3",Limit_of_Discretion3);
// productData.put("Limit_of_Discretion4",Limit_of_Discretion4);
// productData.put("Limit_of_Discretion5",Limit_of_Discretion5);
// productData.put("Limit_of_Discretion6",Limit_of_Discretion6);
// productData.put("Limit_of_Discretion7",Limit_of_Discretion7);
// productData.put("Limit_of_Discretion8",Limit_of_Discretion8);
// productData.put("Aggregate_First_Loss1",Aggregate_First_Loss1);
// productData.put("Aggregate_First_Loss2",Aggregate_First_Loss2);
// productData.put("Aggregate_First_Loss3",Aggregate_First_Loss3);
// productData.put("Aggregate_First_Loss4",Aggregate_First_Loss4);
// productData.put("Aggregate_First_Loss5",Aggregate_First_Loss5);
// productData.put("Aggregate_First_Loss6",Aggregate_First_Loss6);
// productData.put("Aggregate_First_Loss7",Aggregate_First_Loss7);
// productData.put("Aggregate_First_Loss8",Aggregate_First_Loss8);
// productData.put("Maximum_Liability1",Maximum_Liability1);
// productData.put("Maximum_Liability2",Maximum_Liability2);
// productData.put("Maximum_Liability3",Maximum_Liability3);
// productData.put("Maximum_Liability4",Maximum_Liability4);
// productData.put("Maximum_Liability5",Maximum_Liability5);
// productData.put("Maximum_Liability6",Maximum_Liability6);
// productData.put("Maximum_Liability7",Maximum_Liability7);
// productData.put("Maximum_Liability8",Maximum_Liability8);
// productData.put("Insured_Percentage1",Insured_Percentage1);
// productData.put("Insured_Percentage2",Insured_Percentage2);
// productData.put("Insured_Percentage3",Insured_Percentage3);
// productData.put("Insured_Percentage4",Insured_Percentage4);
// productData.put("Insured_Percentage5",Insured_Percentage5);
// productData.put("Insured_Percentage6",Insured_Percentage6);
// productData.put("Insured_Percentage7",Insured_Percentage7);
// productData.put("Insured_Percentage8",Insured_Percentage8);
// productData.put("Policy_Performance_Bonus1",Policy_Performance_Bonus1);
// productData.put("Policy_Performance_Bonus2",Policy_Performance_Bonus2);
// productData.put("Policy_Performance_Bonus3",Policy_Performance_Bonus3);
// productData.put("Policy_Performance_Bonus4",Policy_Performance_Bonus4);
// productData.put("Policy_Performance_Bonus5",Policy_Performance_Bonus5);
// productData.put("Policy_Performance_Bonus6",Policy_Performance_Bonus6);
// productData.put("Policy_Performance_Bonus7",Policy_Performance_Bonus7);
// productData.put("Policy_Performance_Bonus8",Policy_Performance_Bonus8);
// foreignProduct_settings = Map();
// foreignProduct_settings.put("doc_name",Business_Vertical + " " + Deal_Name);
// create_doc = zoho.writer.mergeAndStore(tempID,productData,foreignProduct_settings,"lombardwriter");
// info create_doc;
// document_url = create_doc.get("document_url");
// info document_url;
// url = document_url;
// openUrl(url,"same window");
// return "Added Information Successfully";
foreignProduct_settings = Map();
foreignProduct_settings.put("doc_name",Business_Vertical + " " + Deal_Name);
create_doc = zoho.writer.mergeAndStore(tempID,productData,foreignProduct_settings,"lombardwriter");
info create_doc;
document_url = create_doc.get("document_url");
info document_url;
url = document_url;
openUrl(url,"same window");
return "Added Information Successfully";